<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Portal</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #0a001f; color: #e0f8ff; 
           display: flex; flex-direction: column; align-items: center; justify-content: center; 
           height: 100vh; margin: 0; text-align: center; padding: 20px; overflow-y: auto; }
    h1 { font-size: 2.2em; margin: 10px; text-shadow: 0 0 10px #6a5acd; }
    .input-group { margin: 15px 0; width: 100%; max-width: 420px; }
    select, input, button { 
      font-size: 1.2em; padding: 12px; margin: 6px; border-radius: 10px; border: none; width: 100%; }
    select { background: #2a1b4d; color: white; height: 50px; }
    input { background: #1e1e2e; color: #0f0; text-align: center; }
    button { background: #6a5acd; color: white; cursor: pointer; font-weight: bold; }
    button:hover { background: #8a2be2; }
    #status { margin-top: 20px; font-size: 1.3em; min-height: 1.5em; color: #0f0; }
    .color-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin: 12px 0; }
    .color-btn { padding: 16px; border-radius: 12px; font-weight: bold; color: white; cursor: pointer; font-size: 0.9em; }
    .color-btn:active { transform: scale(0.95); }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js";

    // YOUR FIREBASE CONFIG
    const firebaseConfig = {
      apiKey: "AIzaSyCYBN6ffuq_9KhhDep5ZbEAvzV2uPhxpkQ",
      authDomain: "halloween2025-sync.firebaseapp.com",
      projectId: "halloween2025-sync",
      storageBucket: "halloween2025-sync.firebasestorage.app",
      messagingSenderId: "93312253295",
      appId: "1:93312253295:web:389a98efa6c30c0e227c9a",
      databaseURL: "https://halloween2025-sync-default-rtdb.firebaseio.com"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    let selectedColors = [];
    const CLUES = {
      num: '5210',
      colors: ['BLUE','ORANGE','PURPLE','GREEN'],
      date: { m: 'Ennuary', d: 31, y: 1540 }
    };

    const colorData = [
      { name: 'BLUE',   color: '#3498db' }, { name: 'ORANGE', color: '#e67e22' },
      { name: 'PURPLE', color: '#9b59b6' }, { name: 'GREEN',  color: '#27ae60' },
      { name: 'YELLOW', color: '#f1c40f' }, { name: 'RED',    color: '#e74c3c' },
      { name: 'BROWN',  color: '#8b4513' }, { name: 'BLACK',  color: '#2c3e50' },
      { name: 'WHITE',  color: '#ecf0f1' }
    ];

    function shuffle(a) { for (let i = a.length-1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }
    function renderColorGrid() {
      const grid = document.getElementById('color-grid'); grid.innerHTML = '';
      shuffle([...colorData]).forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'color-btn'; btn.style.backgroundColor = item.color;
        btn.textContent = item.name; btn.onclick = () => addColor(item.name);
        grid.appendChild(btn);
      });
    }
    function addColor(c) { if (selectedColors.length >= 4) return; selectedColors.push(c); document.getElementById('colors').value = selectedColors.join(', '); }
    function resetColors() { selectedColors = []; document.getElementById('colors').value = ''; }

    function tryClue(type) {
      const status = document.getElementById('status');
      let correct = false;
      let clueKey = null;

      if (type === 'num' && document.getElementById('num').value.trim() === CLUES.num) { correct = true; clueKey = 'num'; }
      if (type === 'colors' && selectedColors.length === 4 && selectedColors.join(',') === CLUES.colors.join(',')) { correct = true; clueKey = 'colors'; resetColors(); }
      if (type === 'date') {
        const m = document.getElementById('month').value;
        const d = parseInt(document.getElementById('day').value);
        const y = parseInt(document.getElementById('year').value);
        if (m === CLUES.date.m && d === CLUES.date.d && y === CLUES.date.y) { correct = true; clueKey = 'date'; }
      }

      if (correct) {
        set(ref(db, 'clue'), {
          clue: clueKey,
          time: Date.now()
        });
        status.innerHTML = `CLUE SENT: ${clueKey.toUpperCase()}<br>Go to DEX â†’ PLAY`;
      } else {
        status.textContent = 'Invalid clue.';
      }
      setTimeout(() => status.textContent = '', 5000);
    }

    window.onload = () => { renderColorGrid(); selectedColors = []; document.getElementById('colors').value = ''; };
  </script>
</body>
</html>
